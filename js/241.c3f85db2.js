"use strict";(self["webpackChunkvue_demo"]=self["webpackChunkvue_demo"]||[]).push([[241],{2241:function(t,e,a){a.r(e),a.d(e,{default:function(){return K}});var s=a(3396),l=a(7139),o=a(9242);const i={class:"container"},r={class:"row mt-4 d-flex justify-content-center"},n={class:"col-md-5"},d={class:"sticky-top"},c={class:"table align-middle"},u=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"110px"}},"數量"),(0,s._)("th",null,"單價")])],-1),m=["disabled","onClick"],p={key:0,class:"text-success"},h={class:"input-group input-group-sm"},b=["disabled","onUpdate:modelValue","onChange"],_={class:"input-group-text"},f={class:"text-end"},g={key:0,class:"text-success"},v=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),y={class:"text-end"},k={key:0},C=(0,s._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),w={class:"text-end text-success"},x={class:"input-group mb-3 input-group-sm"},V={class:"input-group-append"},$={class:"d-flex justify-content-end"},q={key:0,class:"my-5 row justify-content-center"},W={class:"mb-3"},U=(0,s._)("label",{for:"email",class:"form-label"},"Email",-1),I={class:"mb-3"},P=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),D={class:"mb-3"},L=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),z={class:"mb-3"},O=(0,s._)("label",{for:"address",class:"form-label"},"收件人地址",-1),j={class:"mb-3"},E=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),B={class:"text-end"};function F(t,e,a,F,H,S){const Y=(0,s.up)("Loading"),K=(0,s.up)("router-link"),M=(0,s.up)("btn"),Z=(0,s.up)("Field"),A=(0,s.up)("ErrorMessage"),G=(0,s.up)("Form");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(Y,{active:t.isLoading},null,8,["active"]),(0,s._)("div",i,[(0,s._)("div",r,[(0,s._)("div",n,[(0,s._)("div",d,[(0,s._)("table",c,[u,(0,s._)("tbody",null,[H.cart.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(H.cart.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:H.status.loadingItem===e.id,onClick:t=>S.removeCartItem(e.id)}," 刪除 ",8,m)]),(0,s._)("td",null,[(0,s.Uk)((0,l.zw)(e.product.title)+" ",1),e.coupon?((0,s.wg)(),(0,s.iD)("div",p," 已套用優惠券 ")):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("div",h,[(0,s.wy)((0,s._)("input",{min:"1",type:"number",class:"form-control",disabled:e.id===H.status.loadingItem,"onUpdate:modelValue":t=>e.qty=t,onChange:t=>S.updateCart(e)},null,40,b),[[o.nr,e.qty,void 0,{number:!0}]]),(0,s._)("div",_," / "+(0,l.zw)(e.product.unit),1)])]),(0,s._)("td",f,[H.cart.final_total!==H.cart.total?((0,s.wg)(),(0,s.iD)("small",g,"折扣價(打折後)：")):(0,s.kq)("",!0),(0,s.Uk)(" "+(0,l.zw)(t.$filters.currency(e.final_total)),1)])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[v,(0,s._)("td",y,(0,l.zw)(t.$filters.currency(H.cart.total)),1)]),H.cart.final_total!==H.cart.total?((0,s.wg)(),(0,s.iD)("tr",k,[C,(0,s._)("td",w,(0,l.zw)(t.$filters.currency(H.cart.final_total)),1)])):(0,s.kq)("",!0)])]),(0,s._)("div",x,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>H.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.nr,H.coupon_code]]),(0,s._)("div",V,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=(...t)=>S.addCouponCode&&S.addCouponCode(...t))}," 套用優惠碼 ")])]),(0,s._)("div",$,[(0,s.Wm)(M,{type:"button",class:"btn btn-primary"},{default:(0,s.w5)((()=>[(0,s.Wm)(K,{class:"navbar-brand",to:"/user/productslist"},{default:(0,s.w5)((()=>[(0,s.Uk)("繼續購買")])),_:1})])),_:1}),(0,s.Wm)(M,{type:"button",class:"btn btn-warning",onClick:S.goPayBtn},{default:(0,s.w5)((()=>[(0,s.Uk)("結帳去")])),_:1},8,["onClick"])])])])]),H.goPay?((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Wm)(G,{class:"col-md-6",onSubmit:S.createOrder},{default:(0,s.w5)((({errors:a})=>[(0,s._)("div",W,[U,(0,s.Wm)(Z,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":a["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:H.form.user.email,"onUpdate:modelValue":e[2]||(e[2]=t=>H.form.user.email=t)},null,8,["class","modelValue"]),(0,s.Wm)(A,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",I,[P,(0,s.Wm)(Z,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":a["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:H.form.user.name,"onUpdate:modelValue":e[3]||(e[3]=t=>H.form.user.name=t)},null,8,["class","modelValue"]),(0,s.Wm)(A,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",D,[L,(0,s.Wm)(Z,{id:"tel",name:"電話",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":a["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:H.form.user.tel,"onUpdate:modelValue":e[4]||(e[4]=t=>H.form.user.tel=t)},null,8,["class","modelValue"]),(0,s.Wm)(A,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",z,[O,(0,s.Wm)(Z,{id:"address",name:"地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":a["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:H.form.user.address,"onUpdate:modelValue":e[5]||(e[5]=t=>H.form.user.address=t)},null,8,["class","modelValue"]),(0,s.Wm)(A,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",j,[E,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[6]||(e[6]=t=>H.form.message=t)},null,512),[[o.nr,H.form.message]])]),(0,s._)("div",B,[(0,s._)("button",{class:"btn btn-danger",onClick:e[7]||(e[7]=(...e)=>t.goPayOrder&&t.goPayOrder(...e))},"送出訂單")])])),_:1},8,["onSubmit"])])):(0,s.kq)("",!0)])],64)}a(7658);var H={data(){return{products:[],product:{},status:{loadingItem:""},form:{user:{name:"",email:"",tel:"",address:""},message:""},cart:{},coupon_code:"",goPay:!1}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/binbro-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const e="https://vue3-course-api.hexschool.io/api/binbro-api/cart";this.status.loadingItem=t;const a={product_id:t,qty:1};this.$http.post(e,{data:a}).then((()=>{this.status.loadingItem=""}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/binbro-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/binbro-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:a}).then((()=>{this.status.loadingItem="",this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/binbro-api/coupon",e={code:this.coupon_code};this.$http.post(t,{data:e}).then((()=>{this.getCart()}))},createOrder(){const t="https://vue3-course-api.hexschool.io/api/binbro-api/order",e=this.form;this.$http.post(t,{data:e}).then((t=>{t.data.success&&this.$router.push(`/user/checkout/${t.data.orderId}`)}))},removeCartItem(t){const e=`https://vue3-course-api.hexschool.io/api/binbro-api/cart/${t}`;this.$http.delete(e).then((()=>{this.getCart()}))},goPayBtn(){this.goPay=!0}},created(){this.getProducts(),this.getCart()}},S=a(89);const Y=(0,S.Z)(H,[["render",F]]);var K=Y}}]);
//# sourceMappingURL=241.c3f85db2.js.map